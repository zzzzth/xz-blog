{"ast":null,"code":"/*\r\nCopyright 2019 今日诗词\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n*/\n\n// 今日诗词 V2 NPM-SDK 1.0.0\n// 今日诗词API 是一个可以免费调用的诗词接口：https://www.jinrishici.com\n\nconst keyName = \"jinrishici-token\";\nfunction load(callback, errHandler) {\n  if (window.localStorage && window.localStorage.getItem(keyName)) {\n    return commonLoad(callback, errHandler, window.localStorage.getItem(keyName));\n  } else {\n    return corsLoad(callback, errHandler);\n  }\n}\nfunction corsLoad(callback, errHandler) {\n  const newCallBack = function (result) {\n    window.localStorage.setItem(keyName, result.token);\n    callback(result);\n  };\n  return sendRequest(newCallBack, errHandler, \"https://v2.jinrishici.com/one.json?client=npm-sdk/1.0\");\n}\nfunction commonLoad(callback, errHandler, token) {\n  return sendRequest(callback, errHandler, \"https://v2.jinrishici.com/one.json?client=npm-sdk/1.0&X-User-Token=\" + encodeURIComponent(token));\n}\nfunction sendRequest(callback, errHandler, apiUrl) {\n  var xhr = new XMLHttpRequest();\n  xhr.open('get', apiUrl);\n  xhr.withCredentials = true;\n  xhr.send();\n  xhr.onreadystatechange = function () {\n    if (xhr.readyState === 4) {\n      var data = JSON.parse(xhr.responseText);\n      if (data.status === \"success\") {\n        callback(data);\n      } else {\n        if (errHandler) {\n          errHandler(data);\n        } else {\n          console.error(\"今日诗词API加载失败，错误原因：\" + data.errMessage);\n        }\n      }\n    }\n  };\n}\nexport { load };","map":{"version":3,"names":["keyName","load","callback","errHandler","window","localStorage","getItem","commonLoad","corsLoad","newCallBack","result","setItem","token","sendRequest","encodeURIComponent","apiUrl","xhr","XMLHttpRequest","open","withCredentials","send","onreadystatechange","readyState","data","JSON","parse","responseText","status","console","error","errMessage"],"sources":["D:/xz-website/node_modules/jinrishici/jinrishici.js"],"sourcesContent":["/*\r\nCopyright 2019 今日诗词\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n*/\r\n\r\n// 今日诗词 V2 NPM-SDK 1.0.0\r\n// 今日诗词API 是一个可以免费调用的诗词接口：https://www.jinrishici.com\r\n\r\nconst keyName = \"jinrishici-token\";\r\n\r\nfunction load(callback, errHandler) {\r\n    if (window.localStorage && window.localStorage.getItem(keyName)) {\r\n        return commonLoad(callback, errHandler, window.localStorage.getItem(keyName));\r\n    } else {\r\n        return corsLoad(callback, errHandler);\r\n    }\r\n}\r\n\r\nfunction corsLoad(callback, errHandler) {\r\n    const newCallBack = function (result) {\r\n        window.localStorage.setItem(keyName, result.token);\r\n        callback(result);\r\n    };\r\n    return sendRequest(newCallBack, errHandler, \"https://v2.jinrishici.com/one.json?client=npm-sdk/1.0\");\r\n}\r\n\r\nfunction commonLoad(callback, errHandler, token) {\r\n    return sendRequest(callback, errHandler, \"https://v2.jinrishici.com/one.json?client=npm-sdk/1.0&X-User-Token=\" + encodeURIComponent(token));\r\n}\r\n\r\nfunction sendRequest(callback, errHandler, apiUrl) {\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('get', apiUrl);\r\n    xhr.withCredentials = true;\r\n    xhr.send();\r\n    xhr.onreadystatechange = function () {\r\n        if (xhr.readyState === 4) {\r\n            var data = JSON.parse(xhr.responseText);\r\n            if (data.status === \"success\") {\r\n                callback(data);\r\n            } else {\r\n            \tif (errHandler) {\r\n            \t\terrHandler(data);\r\n            \t} else {\r\n                \tconsole.error(\"今日诗词API加载失败，错误原因：\" + data.errMessage);\r\n            \t}\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\nexport {load};"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,MAAMA,OAAO,GAAG,kBAAkB;AAElC,SAASC,IAAIA,CAACC,QAAQ,EAAEC,UAAU,EAAE;EAChC,IAAIC,MAAM,CAACC,YAAY,IAAID,MAAM,CAACC,YAAY,CAACC,OAAO,CAACN,OAAO,CAAC,EAAE;IAC7D,OAAOO,UAAU,CAACL,QAAQ,EAAEC,UAAU,EAAEC,MAAM,CAACC,YAAY,CAACC,OAAO,CAACN,OAAO,CAAC,CAAC;EACjF,CAAC,MAAM;IACH,OAAOQ,QAAQ,CAACN,QAAQ,EAAEC,UAAU,CAAC;EACzC;AACJ;AAEA,SAASK,QAAQA,CAACN,QAAQ,EAAEC,UAAU,EAAE;EACpC,MAAMM,WAAW,GAAG,SAAAA,CAAUC,MAAM,EAAE;IAClCN,MAAM,CAACC,YAAY,CAACM,OAAO,CAACX,OAAO,EAAEU,MAAM,CAACE,KAAK,CAAC;IAClDV,QAAQ,CAACQ,MAAM,CAAC;EACpB,CAAC;EACD,OAAOG,WAAW,CAACJ,WAAW,EAAEN,UAAU,EAAE,uDAAuD,CAAC;AACxG;AAEA,SAASI,UAAUA,CAACL,QAAQ,EAAEC,UAAU,EAAES,KAAK,EAAE;EAC7C,OAAOC,WAAW,CAACX,QAAQ,EAAEC,UAAU,EAAE,qEAAqE,GAAGW,kBAAkB,CAACF,KAAK,CAAC,CAAC;AAC/I;AAEA,SAASC,WAAWA,CAACX,QAAQ,EAAEC,UAAU,EAAEY,MAAM,EAAE;EAC/C,IAAIC,GAAG,GAAG,IAAIC,cAAc,CAAC,CAAC;EAC9BD,GAAG,CAACE,IAAI,CAAC,KAAK,EAAEH,MAAM,CAAC;EACvBC,GAAG,CAACG,eAAe,GAAG,IAAI;EAC1BH,GAAG,CAACI,IAAI,CAAC,CAAC;EACVJ,GAAG,CAACK,kBAAkB,GAAG,YAAY;IACjC,IAAIL,GAAG,CAACM,UAAU,KAAK,CAAC,EAAE;MACtB,IAAIC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACT,GAAG,CAACU,YAAY,CAAC;MACvC,IAAIH,IAAI,CAACI,MAAM,KAAK,SAAS,EAAE;QAC3BzB,QAAQ,CAACqB,IAAI,CAAC;MAClB,CAAC,MAAM;QACN,IAAIpB,UAAU,EAAE;UACfA,UAAU,CAACoB,IAAI,CAAC;QACjB,CAAC,MAAM;UACHK,OAAO,CAACC,KAAK,CAAC,mBAAmB,GAAGN,IAAI,CAACO,UAAU,CAAC;QACxD;MACD;IACJ;EACJ,CAAC;AACL;AAEA,SAAQ7B,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}